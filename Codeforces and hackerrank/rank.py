import csv

a = [{'name': 'gaurang Pawar',
      'id': 'j88bfH5A9UgCRkMULzO5t3iuJJS2',
      'attendance': [['01-09-21', '-'], ['02-09-21', '-'], ['03-09-21', '-'], ['04-09-21', '-'], ['05-09-21', '-'], ['06-09-21', '-'], ['07-09-21', '-'], ['08-09-21', '-'], ['09-09-21', '-'], ['10-09-21', '-'], ['11-09-21', '-'], ['12-09-21', '-'], ['13-09-21', '-'], ['14-09-21', '-'], ['15-09-21', '-'], ['16-09-21', '-'], ['17-09-21', '-'], ['18-09-21', '-'], ['19-09-21', '-'], ['20-09-21', '-'], ['21-09-21', '-'], ['22-09-21', '-'], ['23-09-21', '-'], ['24-09-21', '-'], ['25-09-21', '-'], ['26-09-21', '-'], ['27-09-21', '27/09/21 11:44:03', '-'], ['28-09-21', '28/09/21 02:00:50', '-'], ['29-09-21', 'leave'], ['30-09-21', 'leave']]},
     {'name': 'Atharva',
      'id': 'ls517hrR2dZxCImSDEYLRbRXZBi2',
      'attendance': [['01-09-21', '-'], ['02-09-21', '-'], ['03-09-21', '-'], ['04-09-21', '-'], ['05-09-21', '-'], ['06-09-21', '-'], ['07-09-21', '-'], ['08-09-21', '-'], ['09-09-21', '-'], ['10-09-21', '-'], ['11-09-21', '-'], ['12-09-21', '-'], ['13-09-21', '-'], ['14-09-21', '-'], ['15-09-21', '-'], ['16-09-21', '-'], ['17-09-21', '-'], ['18-09-21', '-'], ['19-09-21', '-'], ['20-09-21', '-'], ['21-09-21', '-'], ['22-09-21', '-'], ['23-09-21', '-'], ['24-09-21', '-'], ['25-09-21', '-'], ['26-09-21', '-'], ['27-09-21', '-'], ['28-09-21', '-'], ['29-09-21', '-'], ['30-09-21', '-']]}]
flag = True
with open("eggs.csv", 'w') as csvfile:
    csvwriter = csv.writer(csvfile)
    row_names = ["Id   ", "Names   "]
    data = []
    for i in a:
        new_lis = [i['id'], i['name']]
        for j in i['attendance']:
            if flag:
                row_names.append(j[0] + "      ")
            if len(j) == 3:
                new_lis.append(j[1] + " to " + j[2])
            else:
                new_lis.append(j[1])
        data.append(new_lis)
        flag = False

    csvwriter.writerow(row_names)
    for i in data:
        csvwriter.writerow(i)